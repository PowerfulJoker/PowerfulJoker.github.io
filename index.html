<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="Keep up!"><meta name="keywords" content=""><meta name="author" content="某獠,undefined"><meta name="copyright" content="某獠"><title>【Joker】</title><link rel="stylesheet" href="/css/fan.css"><link rel="stylesheet" href="/css/thirdparty/jquery.mCustomScrollbar.min.css"><link rel="icon" href="/favicon.ico"><!-- script(src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML")--><script src="/js/mathjax/mathjax.js"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
    tex2jax: {inlineMath: [['$', '$'], ['\\(', '\\)']]}
});
</script><script>var isPassword = '' || false;
if (isPassword) {
    if (prompt('请输入文章密码') !== '') {
        alert('密码错误！');
        history.back();
    }
}</script><script>window.GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  }
}</script></head><body><canvas id="universe"></canvas><!--#body--><div id="sidebar"><div class="author-info"><div class="author-info-avatar"><img class="author-info-avatar-img" src="/avatar.png"></div><div class="author-info-name">某獠</div><div class="author-info-description">Keep up!</div><div class="links-buttons"><a class="links-button button-hover" href="https://github.com/PowerfulJoker/PowerfulJoker.github.io" target="_blank">GitHub<i class="icon-dot bg-color4"></i></a><a class="links-button button-hover" href="mailto:741218399@qq.com" target="_blank">E-Mail<i class="icon-dot bg-color4"></i></a><a class="links-button button-hover" href="tencent://message/?uin=741218399&amp;Site=&amp;Menu=yes" target="_blank">QQ<i class="icon-dot bg-color7"></i></a></div><div class="author-info-articles"><a class="author-info-articles-archives article-meta" href="/archives"><span class="pull-top">日志</span><span class="pull-bottom">14</span></a><a class="author-info-articles-tags article-meta" href="/tags"><span class="pull-top">标签</span><span class="pull-bottom">7</span></a><a class="author-info-articles-categories article-meta" href="/categories"><span class="pull-top">分类</span><span class="pull-bottom">5</span></a></div></div></div><div id="main-container"><header><div id="menu-outer"><i class="menu-list-icon fas fa-bars"></i><nav id="menu-inner"><a class="menu-item" href="/">首页</a><a class="menu-item" href="/tags">标签</a><a class="menu-item" href="/categories">分类</a><a class="menu-item" href="/archives">归档</a><a class="menu-item" href="/about">关于</a></nav><div class="right-info"><a class="title-name" href="/">Joker</a><span id="now-time"></span></div></div></header><div id="content-outer"><div id="content-inner"><div id="recent-posts"><!-- each post in page.posts.sort('date', -1).limit(10).toArray()--><!-- config中配置按照什么排序--><div class="recent-post-item"><a class="post-title" href="/2020/03/11/Python%E5%85%A5%E9%97%A8-%E6%A8%A1%E5%9D%97/">Python入门 -- 模块</a><div class="container"><time class="button-hover post-date"><i class="fas fa-calendar-alt article-icon" aria-hidden="true"></i> 更新于 2020-03-11</time><div class="button-hover tags"><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/Python/">Python</a></div></div><div class="post-content"><div class="main-content content"><p>Python有一种方法可以把定义放在一个文件里，并在脚本或解释器的交互式实例中使用它们。这样的文件被称作<code>模块</code></p>
<h1 id="使用模块"><a href="#使用模块" class="headerlink" title="使用模块"></a>使用模块</h1><p>模块是一个包含Python定义和语句的文件。文件名就是模块名后跟文件后缀 .py 。在一个模块内部，模块名（作为一个字符串）可以通过全局变量<code>_name__</code> 的值获得。<br><br>我们可以使用Python附带的标准模块库，也可以自己来编写模块或使用其他人写的模块(第三方模块)。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python3</span></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">showinfo</span><span class="params">(name=<span class="string">"Joker"</span>,age=<span class="number">20</span>)</span>:</span></span><br><span class="line">    print(<span class="string">"name:"</span>, __name__)</span><br><span class="line">    print(<span class="string">"My name is %s."</span> % name)</span><br><span class="line">    print(<span class="string">"I'm %d years old."</span> % age)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    showinfo()</span><br></pre></td></tr></table></figure>
<p>我们在这个文件目录打开命令行,并通过<code>import</code>关键字导入模块文件，就可以通过模块名后加符号<code>.</code>来访问模块的属性(函数、变量等)：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> mymodule</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>mymodule.showinfo()</span><br><span class="line">name: mymodule</span><br><span class="line">My name <span class="keyword">is</span> Joker.</span><br><span class="line">I<span class="string">'m 20 years old.</span></span><br></pre></td></tr></table></figure>
<p>当我们直接运行这个模块的文件，会发现与它的运行结果会有所不同。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">F:\PyCharmProjects\practice&gt;python mymodule.py</span><br><span class="line">name: __main__</span><br><span class="line">My name <span class="keyword">is</span> Joker.</span><br><span class="line">I<span class="string">'m 20 years old.</span></span><br></pre></td></tr></table></figure>
<p>因为当当模块直接运行时，是以“main”文件的方式执行的时候，<code>__name__</code>被赋值为<code>&quot;__main__&quot;</code>，所以<code>if</code>语句后的内容会执行，而作为模块名时，其<code>__name__</code>的值为模块的文件名。<br><br>要是删除<code>if</code>条件语句，而不删除<code>showinfo()</code>，在使用<code>import</code>语句导入模块时，<code>showinfo()</code>就会被执行。</p>
<h1 id="模块的路径"><a href="#模块的路径" class="headerlink" title="模块的路径"></a>模块的路径</h1><p>当我们导入模块时，python解释器需要找到模块的所在目录，即其所在路径，那么python解释器是怎么搜索路径的呢？<br><br>以刚才创建的模块<code>mymodule</code>为例，解释器首先寻找具有该名称的内置模块。如果没有找到，然后解释器从 sys.path 变量给出的目录列表里寻找名为 mymodule.py 的文件。<br><br>sys.path 初始有这些目录地址:</p>
<ul>
<li>包含输入脚本的目录（或者未指定文件时的当前目录）。</li>
<li>PYTHONPATH(一个包含目录名称的列表，它和shell变量 PATH 有一样的语法)。</li>
<li>取决于安装的默认设置<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> sys</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(sys.path)</span><br><span class="line">[<span class="string">''</span>, <span class="string">'F:\\Program Files\\Python38\\python38.zip'</span>, <span class="string">'F:\\Program Files\\Python38\\DLLs'</span>, <span class="string">'F:\\Program Files\\Python38\\lib'</span>, <span class="string">'F:\\Program Files\\Python38'</span>, <span class="string">'F:\\Program Files\\Python38\\</span></span><br><span class="line"><span class="string">lib\\site-packages'</span>]</span><br></pre></td></tr></table></figure>
在初始化后，Python程序可以更改 sys.path。包含正在运行脚本的文件目录被放在搜索路径的开头处， 在标准库路径之前，<code>&#39;&#39;</code>即代表当前目录。</li>
</ul>
<h1 id="dir-函数"><a href="#dir-函数" class="headerlink" title="dir()函数"></a>dir()函数</h1><p>内置函数 dir() 用于查找模块定义的名称。 它返回一个排序过的字符串列表:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> sys,mymodule</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>dir(mymodule)</span><br><span class="line">[<span class="string">'__builtins__'</span>, <span class="string">'__cached__'</span>, <span class="string">'__doc__'</span>, <span class="string">'__file__'</span>, <span class="string">'__loader__'</span>, <span class="string">'__name__'</span>, <span class="string">'__package__'</span>, <span class="string">'__spec__'</span>, <span class="string">'showinfo'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>dir(sys)</span><br><span class="line">[<span class="string">'__breakpointhook__'</span>, <span class="string">'__displayhook__'</span>, <span class="string">'__doc__'</span>, <span class="string">'__excepthook__'</span>, <span class="string">'__interactivehook__'</span>, <span class="string">'__loader__'</span>, <span class="string">'__name__'</span>, <span class="string">'__package__'</span>, <span class="string">'__spec__'</span>, <span class="string">'__stderr__'</span>, <span class="string">'__stdin__'</span>, <span class="string">'__stdout_</span></span><br><span class="line"><span class="string">_'</span>, <span class="string">'__unraisablehook__'</span>, <span class="string">'_base_executable'</span>, <span class="string">'_clear_type_cache'</span>, <span class="string">'_current_frames'</span>, <span class="string">'_debugmallocstats'</span>, <span class="string">'_enablelegacywindowsfsencoding'</span>, <span class="string">'_framework'</span>, <span class="string">'_getframe'</span>, <span class="string">'_git'</span>, <span class="string">'_home'</span>,</span><br><span class="line"> <span class="string">'_xoptions'</span>, <span class="string">'addaudithook'</span>, <span class="string">'api_version'</span>, <span class="string">'argv'</span>, <span class="string">'audit'</span>, <span class="string">'base_exec_prefix'</span>, <span class="string">'base_prefix'</span>, <span class="string">'breakpointhook'</span>, <span class="string">'builtin_module_names'</span>, <span class="string">'byteorder'</span>, <span class="string">'call_tracing'</span>, <span class="string">'callstats'</span>, <span class="string">'co</span></span><br><span class="line"><span class="string">pyright'</span>, <span class="string">'displayhook'</span>, <span class="string">'dllhandle'</span>, <span class="string">'dont_write_bytecode'</span>, <span class="string">'exc_info'</span>, <span class="string">'excepthook'</span>, <span class="string">'exec_prefix'</span>, <span class="string">'executable'</span>, <span class="string">'exit'</span>, <span class="string">'flags'</span>, <span class="string">'float_info'</span>, <span class="string">'float_repr_style'</span>, <span class="string">'get_asyncgen_hoo</span></span><br><span class="line"><span class="string">ks'</span>, <span class="string">'get_coroutine_origin_tracking_depth'</span>, <span class="string">'getallocatedblocks'</span>, <span class="string">'getcheckinterval'</span>, <span class="string">'getdefaultencoding'</span>, <span class="string">'getfilesystemencodeerrors'</span>, <span class="string">'getfilesystemencoding'</span>, <span class="string">'getprofile'</span>, <span class="string">'getrecu</span></span><br><span class="line"><span class="string">rsionlimit'</span>, <span class="string">'getrefcount'</span>, <span class="string">'getsizeof'</span>, <span class="string">'getswitchinterval'</span>, <span class="string">'gettrace'</span>, <span class="string">'getwindowsversion'</span>, <span class="string">'hash_info'</span>, <span class="string">'hexversion'</span>, <span class="string">'implementation'</span>, <span class="string">'int_info'</span>, <span class="string">'intern'</span>, <span class="string">'is_finalizing'</span>, <span class="string">'last</span></span><br><span class="line"><span class="string">_traceback'</span>, <span class="string">'last_type'</span>, <span class="string">'last_value'</span>, <span class="string">'maxsize'</span>, <span class="string">'maxunicode'</span>, <span class="string">'meta_path'</span>, <span class="string">'modules'</span>, <span class="string">'path'</span>, <span class="string">'path_hooks'</span>, <span class="string">'path_importer_cache'</span>, <span class="string">'platform'</span>, <span class="string">'prefix'</span>, <span class="string">'ps1'</span>, <span class="string">'ps2'</span>, <span class="string">'pycache_prefi</span></span><br><span class="line"><span class="string">x'</span>, <span class="string">'set_asyncgen_hooks'</span>, <span class="string">'set_coroutine_origin_tracking_depth'</span>, <span class="string">'setcheckinterval'</span>, <span class="string">'setprofile'</span>, <span class="string">'setrecursionlimit'</span>, <span class="string">'setswitchinterval'</span>, <span class="string">'settrace'</span>, <span class="string">'stderr'</span>, <span class="string">'stdin'</span>, <span class="string">'stdout'</span>, <span class="string">'t</span></span><br><span class="line"><span class="string">hread_info'</span>, <span class="string">'unraisablehook'</span>, <span class="string">'version'</span>, <span class="string">'version_info'</span>, <span class="string">'warnoptions'</span>, <span class="string">'winver'</span>]</span><br></pre></td></tr></table></figure>
<p>如果没有参数，dir() 会列出你当前定义的名称:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>dir()</span><br><span class="line">[<span class="string">'__annotations__'</span>, <span class="string">'__builtins__'</span>, <span class="string">'__doc__'</span>, <span class="string">'__loader__'</span>, <span class="string">'__name__'</span>, <span class="string">'__package__'</span>, <span class="string">'__spec__'</span>, <span class="string">'mymodule'</span>, <span class="string">'sys'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = <span class="number">1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b = <span class="number">2</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>dir()</span><br><span class="line">[<span class="string">'__annotations__'</span>, <span class="string">'__builtins__'</span>, <span class="string">'__doc__'</span>, <span class="string">'__loader__'</span>, <span class="string">'__name__'</span>, <span class="string">'__package__'</span>, <span class="string">'__spec__'</span>, <span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'mymodule'</span>, <span class="string">'sys'</span>]</span><br></pre></td></tr></table></figure>
<h1 id="包"><a href="#包" class="headerlink" title="包"></a>包</h1><p>包是一种通过用“带点号的模块名”来构造 Python 模块命名空间的方法。目录只有包含一个叫做<code>__init__.py</code>的文件才会被认作是一个包。<br><br>例如，我们可以创建一个名为’test’的包，在<code>test</code>包里写一个列表处理的模块<code>arrayhandle</code>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">reversearray</span><span class="params">(array)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> array[::<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">arraytostr</span><span class="params">(array)</span>:</span></span><br><span class="line">    s = <span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> array:</span><br><span class="line">        s = s + str(a)</span><br><span class="line">    <span class="keyword">return</span> s</span><br></pre></td></tr></table></figure>
<p>我们在这个包所在目录下打开命令行来导入并使用这个包里的模块:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 用import ... 的形式导入</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> test.arrayhandle</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>test.arrayhandle.arraytostr([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>])</span><br><span class="line"><span class="string">'123456'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用from...import... 的形式导入</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> test <span class="keyword">import</span> arrayhandle</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>arrayhandle.arraytostr([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>])</span><br><span class="line"><span class="string">'123456'</span></span><br></pre></td></tr></table></figure>
<p>注意当使用 from package import item 这种形式的时候，对应的 item 既可以是包里面的子模块（子包），或者包里面定义的其他名称，比如函数，类或者变量。例如：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> test.arrayhandle <span class="keyword">import</span> reversearray</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>reversearray([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>])</span><br><span class="line">[<span class="number">8</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>]</span><br></pre></td></tr></table></figure></div></div><a class="button-hover more" href="/2020/03/11/Python%E5%85%A5%E9%97%A8-%E6%A8%A1%E5%9D%97/#more">阅读全文</a></div><div class="recent-post-item"><a class="post-title" href="/2020/03/10/Python%E5%85%A5%E9%97%A8-%E8%A3%85%E9%A5%B0%E5%99%A8/">Python入门 -- 装饰器</a><div class="container"><time class="button-hover post-date"><i class="fas fa-calendar-alt article-icon" aria-hidden="true"></i> 更新于 2020-03-11</time><div class="button-hover categories"><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/Python/">Python</a></div><div class="button-hover tags"><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/Python/">Python</a></div></div><div class="post-content"><div class="main-content content"><p>在代码运行期间动态增加功能的方式，称之为“装饰器”（Decorator）。本质上，decorator就是一个返回函数的高阶函数。<br><br><em>注意，在学习装饰器之前，你需要知道对象、函数嵌套(在函数中定义另一个函数)和高阶函数的概念。</em></p>
<h1 id="一切皆对象"><a href="#一切皆对象" class="headerlink" title="一切皆对象"></a>一切皆对象</h1><p>由于函数也是一个对象，而且函数对象可以被赋值给变量，所以，通过变量也能调用该函数。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>f = abs</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(f(<span class="number">-5</span>))</span><br><span class="line"><span class="number">5</span></span><br><span class="line"><span class="comment"># 函数的名字</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>f.__name__</span><br><span class="line"><span class="string">'abs'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>abs.__name__</span><br><span class="line"><span class="string">'abs'</span></span><br></pre></td></tr></table></figure>

<h1 id="函数嵌套"><a href="#函数嵌套" class="headerlink" title="函数嵌套"></a>函数嵌套</h1><p>在 Python 中我们可以在一个函数中定义另一个函数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">study</span><span class="params">(name=<span class="string">"数学"</span>)</span>:</span></span><br><span class="line"><span class="meta">... </span>    print(<span class="string">"选择课程：%s"</span> % name)</span><br><span class="line"><span class="meta">... </span>    <span class="function"><span class="keyword">def</span> <span class="title">inclass</span><span class="params">()</span>:</span></span><br><span class="line"><span class="meta">... </span>        print(<span class="string">"进入课程"</span>)</span><br><span class="line"><span class="meta">... </span>    inclass()</span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>study()</span><br><span class="line">选择课程：数学</span><br><span class="line">进入课程</span><br></pre></td></tr></table></figure>

<h1 id="编写装饰器"><a href="#编写装饰器" class="headerlink" title="编写装饰器"></a>编写装饰器</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">square</span><span class="params">(array)</span>:</span></span><br><span class="line">    rt = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> array:</span><br><span class="line">        rt.append(i**<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">return</span> rt</span><br></pre></td></tr></table></figure>
<p>假设我们需要统计一个已经写好的函数<code>square()</code>的运行时间但不能改变这个函数体内的定义，此时就可以定义一个装饰器。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">logruntime</span><span class="params">(func)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(*args,**dargs)</span>:</span> <span class="comment"># f()函数可以接受任意参数的调用</span></span><br><span class="line">        start = time.time()</span><br><span class="line">        s = func(*args, **dargs) </span><br><span class="line">        end = time.time()</span><br><span class="line">        print(<span class="string">"运行时间为：%s"</span> % (end-start))</span><br><span class="line">        <span class="keyword">return</span> s</span><br><span class="line">    <span class="keyword">return</span> f</span><br><span class="line"></span><br><span class="line"><span class="comment"># logruntime是一个decorator，所以接受一个函数作为参数，并返回一个函数。我们要借助Python的@语法，把decorator置于函数的定义处</span></span><br><span class="line"><span class="meta">@logruntime</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">square</span><span class="params">(array)</span>:</span></span><br><span class="line">    rt = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> array:</span><br><span class="line">        rt.append(i**<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">return</span> rt</span><br><span class="line">square(range(<span class="number">1000000</span>))</span><br></pre></td></tr></table></figure>
<p>调用<code>square()</code>函数，不仅会运行<code>square()</code>函数本身，还会在运行<code>square()</code>函数前打印一行日志：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">运行时间为：<span class="number">0.34217023849487305</span></span><br></pre></td></tr></table></figure>
<p>把<code>@logruntime</code>放到<code>square</code>函数的定义处，相当于执行了语句：<code>newsquare = logruntime(square)</code></p>
<h1 id="三层嵌套"><a href="#三层嵌套" class="headerlink" title="三层嵌套"></a>三层嵌套</h1><p>以上说的装饰器属于二层嵌套的函数，如果decorator本身需要传入参数，因为其传参只能为一个，所以需要再嵌套一层函数来传递其它参数。也即是说编写一个返回decorator的高阶函数，形成三层嵌套。比如，要自定义<code>logruntime</code>的标记文本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">logruntime</span><span class="params">(flag)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">decorator</span><span class="params">(func)</span>:</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(*args, **dargs)</span>:</span></span><br><span class="line">            start = time.time()</span><br><span class="line">            s = func(*args, **dargs)</span><br><span class="line">            end = time.time()</span><br><span class="line">            print(<span class="string">"%s运行时间为：%s"</span> % (flag,(end - start)))</span><br><span class="line">            <span class="keyword">return</span> s</span><br><span class="line">        <span class="keyword">return</span> f</span><br><span class="line">    <span class="keyword">return</span> decorator</span><br><span class="line"></span><br><span class="line"><span class="meta">@logruntime('square()函数')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">square</span><span class="params">(array)</span>:</span></span><br><span class="line">    rt = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> array:</span><br><span class="line">        rt.append(i**<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">return</span> rt</span><br><span class="line">square(range(<span class="number">1000000</span>))</span><br></pre></td></tr></table></figure>
<p>运行结果为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">square()函数运行时间为：<span class="number">0.35444068908691406</span></span><br></pre></td></tr></table></figure>


</div></div><a class="button-hover more" href="/2020/03/10/Python%E5%85%A5%E9%97%A8-%E8%A3%85%E9%A5%B0%E5%99%A8/#more">阅读全文</a></div><div class="recent-post-item"><a class="post-title" href="/2020/03/09/Python%E5%85%A5%E9%97%A8-%E8%BF%AD%E4%BB%A3%E5%99%A8%E4%B8%8E%E7%94%9F%E6%88%90%E5%99%A8/">Python入门 -- 迭代器、生成器和三元处理符</a><div class="container"><time class="button-hover post-date"><i class="fas fa-calendar-alt article-icon" aria-hidden="true"></i> 更新于 2020-03-11</time><div class="button-hover categories"><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/Python%E5%85%A5%E9%97%A8/">Python入门</a></div><div class="button-hover tags"><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/Python/">Python</a></div></div><div class="post-content"><div class="main-content content"><p>迭代器是一个可以记住遍历的位置的对象。迭代器对象从集合的第一个元素开始访问，直到所有的元素被访问完结束。迭代器只能往前不会后退。</p>
<h1 id="迭代器"><a href="#迭代器" class="headerlink" title="迭代器"></a>迭代器</h1><h2 id="迭代器协议的幕后机制"><a href="#迭代器协议的幕后机制" class="headerlink" title="迭代器协议的幕后机制"></a>迭代器协议的幕后机制</h2><p>for 语句用于对序列（例如字符串、元组或列表）或其他可迭代对象中的元素进行迭代:</p>
<pre><code>for_stmt ::=  &quot;for&quot; target_list &quot;in&quot; expression_list &quot;:&quot; suite
              [&quot;else&quot; &quot;:&quot; suite]</code></pre><p>for 语句会在容器对象上调用 iter()来生成一个可迭代对象。 该函数返回一个定义了 <strong>next</strong>() 方法的迭代器对象，此方法将逐一访问容器中的元素。 当元素用尽时，<strong>next</strong>() 将引发 StopIteration 异常来通知终止 for 循环。可以使用 next() 内置函数来调用 <strong>next</strong>() 方法；以下例子显示了它的运作方式:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = <span class="string">"joker"</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>it = iter(s)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(next(it))</span><br><span class="line">j</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(it.__next__())</span><br><span class="line">o</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(next(it))</span><br><span class="line">k</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(it.__next__())</span><br><span class="line">e</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(next(it))</span><br><span class="line">r</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(next(it))</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">StopIteration</span><br></pre></td></tr></table></figure>

<h2 id="创建迭代器"><a href="#创建迭代器" class="headerlink" title="创建迭代器"></a>创建迭代器</h2><p>看过迭代器协议的幕后机制，我们来尝试为类添加迭代器。 定义一个 <strong>iter</strong>() 方法来返回一个带有 <strong>next</strong>() 方法的对象。 如果类已定义了 <strong>next</strong>()，则 <strong>iter</strong>() 可以简单地返回 self:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Square</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, data)</span>:</span></span><br><span class="line">        self.data = data</span><br><span class="line">        self.index = <span class="number">-1</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__iter__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__next__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.index += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> self.index == len(self.data):</span><br><span class="line">            <span class="keyword">raise</span> StopIteration</span><br><span class="line">        <span class="keyword">return</span> (self.data[self.index]**<span class="number">2</span>)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    nums = Square([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>])</span><br><span class="line">    <span class="keyword">for</span> num <span class="keyword">in</span> nums:</span><br><span class="line">        print(num)</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1</span><br><span class="line">4</span><br><span class="line">9</span><br><span class="line">16</span><br><span class="line">25</span><br></pre></td></tr></table></figure>
<p><em>可以随便写个类来尝试一下效果，以更好的理解器运行方式</em></p>
<h1 id="生成器"><a href="#生成器" class="headerlink" title="生成器"></a>生成器</h1><p>生成器是一个用于创建迭代器的简单而强大的工具。当它们要返回数据时使用 yield 语句。每次对生成器调用 next() 时，它会从上次离开位置恢复执行（它会记住上次执行语句时的所有数据值）。<br><br>创建生成器的示例如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 自己写的例子</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">square</span><span class="params">(array)</span>:</span></span><br><span class="line"><span class="meta">... </span>    <span class="keyword">for</span> i <span class="keyword">in</span> array:</span><br><span class="line"><span class="meta">... </span>            <span class="keyword">yield</span> i**<span class="number">2</span></span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> squ <span class="keyword">in</span> square([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]):</span><br><span class="line"><span class="meta">... </span>    print(squ)</span><br><span class="line">...</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="number">9</span></span><br><span class="line"><span class="number">16</span></span><br><span class="line"><span class="number">25</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># python文档中的例子</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">reverse</span><span class="params">(data)</span>:</span></span><br><span class="line"><span class="meta">... </span>    <span class="keyword">for</span> index <span class="keyword">in</span> range(len(data)<span class="number">-1</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line"><span class="meta">... </span>        <span class="keyword">yield</span> data[index]</span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> char <span class="keyword">in</span> reverse(<span class="string">'golf'</span>):</span><br><span class="line"><span class="meta">... </span>    print(char)</span><br><span class="line">...</span><br><span class="line">f</span><br><span class="line">l</span><br><span class="line">o</span><br><span class="line">g</span><br><span class="line"></span><br><span class="line"><span class="comment"># 保持程序状态的特性，使得要使用的内存空间小，效率高</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">square</span><span class="params">(array)</span>:</span></span><br><span class="line"><span class="meta">... </span>    <span class="keyword">for</span> i <span class="keyword">in</span> array:</span><br><span class="line"><span class="meta">... </span>        print(<span class="string">"开始处理第%d个数"</span> % i)</span><br><span class="line"><span class="meta">... </span>        <span class="keyword">yield</span> i**<span class="number">2</span></span><br><span class="line"><span class="meta">... </span>        print(<span class="string">"第%d个数处理完毕"</span> % i)</span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sq = square([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(sq.__next__())</span><br><span class="line">开始处理第<span class="number">1</span>个数</span><br><span class="line"><span class="number">1</span>			<span class="comment"># 程序状态保存于yield语句执行后的状态</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(next(sq)) <span class="comment"># 从yield语句后开始执行</span></span><br><span class="line">第<span class="number">1</span>个数处理完毕</span><br><span class="line">开始处理第<span class="number">2</span>个数</span><br><span class="line"><span class="number">4</span></span><br></pre></td></tr></table></figure>
<ol>
<li>自动创建方法：比起使用上面所描述的基于类的迭代器来完成该操作，生成器的写法更为紧凑，因为它会自动创建 <code>__iter__()</code> 和 <code>__next__()</code> 方法。</li>
<li>保存程序状态：生成器的一个关键特性：<code>局部变量和执行状态会在每次调用之间自动保存</code>。 这使得该函数相比使用 <code>self.index</code> 和 <code>self.data</code>这种实例变量的方式更易编写且更为清晰。</li>
<li>当生成器终结时，它们会自动引发 StopIteration。<br>正是由于特性结合在一起，使得创建迭代器能与编写常规函数一样容易。</li>
</ol>
<h1 id="三元运算符"><a href="#三元运算符" class="headerlink" title="三元运算符"></a>三元运算符</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = <span class="number">1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b = <span class="number">2</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>max = a <span class="keyword">if</span> a &gt; b <span class="keyword">else</span> b</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(max)</span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="comment"># 类似于其它语言中的 max = a &gt; b ? a : b</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 二元表达式，2个i</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>l = [<span class="string">'%s只羊'</span> % i <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">11</span>)]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(l)</span><br><span class="line">[<span class="string">'1只羊'</span>, <span class="string">'2只羊'</span>, <span class="string">'3只羊'</span>, <span class="string">'4只羊'</span>, <span class="string">'5只羊'</span>, <span class="string">'6只羊'</span>, <span class="string">'7只羊'</span>, <span class="string">'8只羊'</span>, <span class="string">'9只羊'</span>, <span class="string">'10只羊'</span>]</span><br><span class="line"><span class="comment"># 三元表达式，3个i</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>l2 = [<span class="string">'%s只羊'</span> % i <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">100</span>) <span class="keyword">if</span> i &lt; <span class="number">11</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(l2)</span><br><span class="line">[<span class="string">'1只羊'</span>, <span class="string">'2只羊'</span>, <span class="string">'3只羊'</span>, <span class="string">'4只羊'</span>, <span class="string">'5只羊'</span>, <span class="string">'6只羊'</span>, <span class="string">'7只羊'</span>, <span class="string">'8只羊'</span>, <span class="string">'9只羊'</span>, <span class="string">'10只羊'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>l3 = (<span class="string">'%s只羊'</span> % i <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">100</span>) <span class="keyword">if</span> i &lt; <span class="number">11</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(l3)</span><br><span class="line">&lt;generator object &lt;genexpr&gt; at <span class="number">0x0000023DD8C4D900</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 用[]结果为列表，用()结果为生成器</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>type(l)</span><br><span class="line">&lt;<span class="class"><span class="keyword">class</span> '<span class="title">list</span>'&gt;</span></span><br><span class="line"><span class="class">&gt;&gt;&gt; <span class="title">type</span><span class="params">(l2)</span></span></span><br><span class="line"><span class="class">&lt;<span class="title">class</span> '<span class="title">list</span>'&gt;</span></span><br><span class="line"><span class="class">&gt;&gt;&gt; <span class="title">type</span><span class="params">(l3)</span></span></span><br><span class="line"><span class="class">&lt;<span class="title">class</span> '<span class="title">generator</span>'&gt;</span></span><br></pre></td></tr></table></figure></div></div><a class="button-hover more" href="/2020/03/09/Python%E5%85%A5%E9%97%A8-%E8%BF%AD%E4%BB%A3%E5%99%A8%E4%B8%8E%E7%94%9F%E6%88%90%E5%99%A8/#more">阅读全文</a></div><div class="recent-post-item"><a class="post-title" href="/2020/03/08/Python%E5%85%A5%E9%97%A8-%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/">Python入门 -- 文件处理</a><div class="container"><time class="button-hover post-date"><i class="fas fa-calendar-alt article-icon" aria-hidden="true"></i> 更新于 2020-03-08</time><div class="button-hover categories"><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/Python%E5%85%A5%E9%97%A8/">Python入门</a></div><div class="button-hover tags"><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/Python/">Python</a></div></div><div class="post-content"><div class="main-content content"><h1 id="open-方法"><a href="#open-方法" class="headerlink" title="open()方法"></a>open()方法</h1><p>Python open() 方法用于打开一个文件，并返回一个文件对象。<br><br>语法：<code>open(file, mode=&#39;r&#39;, buffering=-1, encoding=None, errors=None, newline=None, closefd=True, opener=None)</code></p>
<ul>
<li>file: 将要打开的文件的路径(绝对路径或相对路径)。</li>
<li>mode: 可选，文件打开模式</li>
<li>buffering: 设置缓冲</li>
<li>encoding: 一般使用utf8</li>
<li>errors: 报错级别</li>
<li>newline: 区分换行符</li>
<li>closefd: 传入的file参数类型</li>
<li>opener: 自定义开启器。通过使用参数(file，flags)调用opener获得文件对象的基础文件描述符。</li>
</ul>
<p>mode模式：</p>
<ul>
<li>‘r’ 读取（默认）</li>
<li>‘w’ 写入，并先截断文件</li>
<li>‘x’ 排它性创建，如果文件已存在则失败</li>
<li>‘a’ 写入，如果文件存在则在末尾追加</li>
<li>‘b’ 二进制模式</li>
<li>‘t’ 文本模式（默认）</li>
<li>‘+’ 打开用于更新（读取与写入）</li>
</ul>
<p>file为open()函数创建的对象：</p>
<ul>
<li>file.close()关闭文件。关闭后文件不能再进行读写操作。</li>
<li>file.read(size) 从文件读取指定的字节数，如果未给定或为负则读取所有。</li>
</ul>
<ul>
<li>file.readline([size]) 读取整行，包括 “\n” 字符。</li>
<li>file.readlines([sizeint]) 读取所有行并返回列表，若给定sizeint&gt;0，返回总和大约为sizeint字节的行, 实际读取值可能比 sizeint 较大, 因为需要填充缓冲区。</li>
<li>file.seek(offset[, whence]) 用于移动文件读取指针到指定位置。<pre><code>offset -- 开始的偏移量，也就是代表需要移动偏移的字节数，如果是负数表示从倒数第几位开始。
whence：可选，默认值为 0。给 offset 定义一个参数，表示要从哪个位置开始偏移；0 代表从文件开头开始算起，1 代表从当前位置开始算起，2 代表从文件末尾算起。</code></pre></li>
<li>fiel.truncate([size]) 从文件的首行首字符开始截断，截断文件为size个字符，无 size 表示从当前位置截断；截断之后后面的所有字符被删除，其中 Widnows 系统下的换行代表2个字符大小。    </li>
<li>file.write(str) 将字符串写入文件，返回的是写入的字符长度。</li>
<li>file.writelines(sequence) 向文件写入一个序列字符串列表，如果需要换行则要自己加入每行的换行符。</li>
</ul>
</div></div><a class="button-hover more" href="/2020/03/08/Python%E5%85%A5%E9%97%A8-%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/#more">阅读全文</a></div><div class="recent-post-item"><a class="post-title" href="/2020/03/06/Python%E5%85%A5%E9%97%A8-%E5%86%85%E7%BD%AE%E5%87%BD%E6%95%B0/">Python入门 -- 高阶函数</a><div class="container"><time class="button-hover post-date"><i class="fas fa-calendar-alt article-icon" aria-hidden="true"></i> 更新于 2020-03-10</time><div class="button-hover categories"><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/Python%E5%85%A5%E9%97%A8/">Python入门</a></div><div class="button-hover tags"><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/Python/">Python</a></div></div><div class="post-content"><div class="main-content content"><h1 id="高阶函数"><a href="#高阶函数" class="headerlink" title="高阶函数"></a>高阶函数</h1><p>高阶函数的特征在于函数的参数能够接收别的函数。示例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">hightfunc</span><span class="params">(func,a,b)</span>:</span></span><br><span class="line"><span class="meta">... </span>    <span class="keyword">return</span> func(a) + func(b)</span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>h = hightfunc(abs,<span class="number">-5</span>,<span class="number">3</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(h)</span><br><span class="line"><span class="number">8</span></span><br></pre></td></tr></table></figure>
<p>常用的Python内建的高阶函数有<code>map()</code>、<code>reduce()</code>、<code>filter()</code>和<code>sorted()</code> 函数。</p>
<h1 id="map-函数"><a href="#map-函数" class="headerlink" title="map()函数"></a>map()函数</h1><p>语法：<code>map(function, iterable, ...)</code><br><br>map()函数将function(函数)应用于 iterable(迭代器)中每一项，并返回一个迭代器。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>y = map(<span class="keyword">lambda</span> x:x*<span class="number">2</span>,[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(list(y))</span><br><span class="line">[<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">10</span>]</span><br></pre></td></tr></table></figure>

<h1 id="filter-函数"><a href="#filter-函数" class="headerlink" title="filter()函数"></a>filter()函数</h1><p>语法<code>filter(function, iterable)</code><br><br><code>filter()</code> 函数将iterable(迭代器)中元素应用于function(函数)中，将返回真的那些元素构建一个新的迭代器返回。<br><em>iterable 可以是一个序列，一个支持迭代的容器，或一个迭代器。如果 function 是 None ，则会假设它是一个身份函数，即 iterable 中所有返回假的元素会被移除。</em></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>y = filter(<span class="keyword">lambda</span> x:(x%<span class="number">2</span>==<span class="number">0</span>),[<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(list(y))</span><br><span class="line">[<span class="number">0</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># function为None时，相当于lambda x:bool(x)</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>m = filter(<span class="literal">None</span>,[<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(list(m))</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]</span><br></pre></td></tr></table></figure>

<h1 id="reduce-函数"><a href="#reduce-函数" class="headerlink" title="reduce()函数"></a>reduce()函数</h1><p><em>在 Python3 中，reduce()被放置在 functools 模块里，如果想要使用它，则需要通过引入 functools 模块来调用 reduce() 函数：</em><code>from functools import reduce</code><br><br>语法：<code>reduce(function, iterable[, initializer])</code><br></p>
<ul>
<li>function – 函数，有两个参数</li>
<li>iterable – 可迭代对象</li>
<li>initializer – 可选，初始参数</li>
</ul>
<p>将两个参数的<code>function</code>从左至右积累地应用到<code>iterable</code>的条目，以便将该可迭代对象缩减为单一的值。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; from functools import reduce</span><br><span class="line">&gt;&gt;&gt; m = reduce(lambda x, y: x*y, [1,2,3,4,5,6,7,8])</span><br><span class="line">&gt;&gt;&gt; print(m)</span><br><span class="line">40320</span><br></pre></td></tr></table></figure>

<h1 id="sorted-函数"><a href="#sorted-函数" class="headerlink" title="sorted()函数"></a>sorted()函数</h1><p>sorted() 函数对所有可迭代的对象进行排序操作。<br><br>语法：<code>sorted(iterable, key=None, reverse=False)</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>d = &#123;<span class="string">"Mike"</span>:<span class="number">20</span>,<span class="string">"Amy"</span>:<span class="number">18</span>,<span class="string">"Joker"</span>:<span class="number">21</span>,<span class="string">"John"</span>:<span class="number">25</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(sorted(d,key = <span class="keyword">lambda</span> x: d[x],reverse=<span class="literal">False</span>))</span><br><span class="line">[<span class="string">'Amy'</span>, <span class="string">'Mike'</span>, <span class="string">'Joker'</span>, <span class="string">'John'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(sorted(zip(d.values(), d.keys())))</span><br><span class="line">[(<span class="number">18</span>, <span class="string">'Amy'</span>), (<span class="number">20</span>, <span class="string">'Mike'</span>), (<span class="number">21</span>, <span class="string">'Joker'</span>), (<span class="number">25</span>, <span class="string">'John'</span>)]</span><br></pre></td></tr></table></figure>
</div></div><a class="button-hover more" href="/2020/03/06/Python%E5%85%A5%E9%97%A8-%E5%86%85%E7%BD%AE%E5%87%BD%E6%95%B0/#more">阅读全文</a></div><div class="recent-post-item"><a class="post-title" href="/2020/03/03/Python%E5%85%A5%E9%97%A8-%E5%87%BD%E6%95%B0/">Python入门 -- 函数</a><div class="container"><time class="button-hover post-date"><i class="fas fa-calendar-alt article-icon" aria-hidden="true"></i> 更新于 2020-03-08</time><div class="button-hover categories"><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/Python%E5%85%A5%E9%97%A8/">Python入门</a></div><div class="button-hover tags"><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/Python/">Python</a></div></div><div class="post-content"><div class="main-content content"><h1 id="定义函数"><a href="#定义函数" class="headerlink" title="定义函数"></a>定义函数</h1><ul>
<li>函数代码块以 def 关键词开头，后接函数标识符名称和圆括号 ()。</li>
<li>任何传入参数和自变量必须放在圆括号中间，圆括号之间可以用于定义参数。</li>
<li>函数的第一行语句可以选择性地使用文档字符串—用于存放函数说明。</li>
<li>函数内容以冒号起始，并且缩进。</li>
<li>return [表达式] 结束函数，选择性地返回一个值给调用方。不带表达式的return相当于返回 None。</li>
</ul>
<h1 id="函数格式"><a href="#函数格式" class="headerlink" title="函数格式"></a>函数格式</h1> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">def 函数名（参数列表）:</span><br><span class="line">	函数体</span><br></pre></td></tr></table></figure>
<h1 id="参数默认值"><a href="#参数默认值" class="headerlink" title="参数默认值"></a>参数默认值</h1><p>对一个或多个参数指定一个默认值。这样创建的函数，可以用比定义时允许的更少的参数调用，例如:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">printinfo</span><span class="params">(age,name = <span class="string">"joker"</span>)</span>:</span></span><br><span class="line">    print(name)</span><br><span class="line">    print(<span class="string">"age = "</span>,age)</span><br><span class="line">printinfo(<span class="string">"Joker"</span>)</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Joker</span><br><span class="line">age =  18</span><br></pre></td></tr></table></figure>
<p><em>注意，赋予了默认值的参数不能写在没有默认值参数的前头</em></p>
<h1 id="关键字参数"><a href="#关键字参数" class="headerlink" title="关键字参数"></a>关键字参数</h1><p>在调用函数时，使用 kwarg=valuem的形式的参数(关键字参数)来传递参数，关键字参数的位置可比较随意。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">printinfo</span><span class="params">(name,age=<span class="number">18</span>,height=<span class="number">180</span>,weight=<span class="number">150</span>)</span>:</span></span><br><span class="line">    print(name)</span><br><span class="line">    print(<span class="string">"age = "</span>,age)</span><br><span class="line">    print(<span class="string">"height = "</span>,height)</span><br><span class="line">    print(<span class="string">"weight = "</span>,weight)</span><br><span class="line">printinfo(name = <span class="string">"Joker"</span>)  <span class="comment"># 一个关键字参数</span></span><br><span class="line">printinfo(height=<span class="number">178</span>,name=<span class="string">"Hacker"</span>) <span class="comment"># 两个关键字参数，参数位置随意</span></span><br><span class="line">printinfo(<span class="string">"Mike"</span>,<span class="number">20</span>,<span class="number">178</span>,<span class="number">135</span>) <span class="comment"># 使用位置参数</span></span><br><span class="line">printinfo(weight=<span class="number">130</span>,height=<span class="number">175</span>,age=<span class="number">20</span>,name=<span class="string">"John"</span>) <span class="comment"># 使用4个关键字参数，参数位置任意</span></span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Joker</span><br><span class="line">age =  18</span><br><span class="line">height =  180</span><br><span class="line">weight =  150</span><br><span class="line">Hacker</span><br><span class="line">age =  18</span><br><span class="line">height =  178</span><br><span class="line">weight =  150</span><br><span class="line">Mike</span><br><span class="line">age =  20</span><br><span class="line">height =  178</span><br><span class="line">weight =  135</span><br><span class="line">John</span><br><span class="line">age =  20</span><br><span class="line">height =  175</span><br><span class="line">weight =  130</span><br></pre></td></tr></table></figure>

<h1 id="特殊参数"><a href="#特殊参数" class="headerlink" title="特殊参数"></a>特殊参数</h1><h2 id="和"><a href="#和" class="headerlink" title="/ 和 *"></a>/ 和 *</h2><p>当<code>/</code>(正斜杠)作为参数时，<code>/</code>(正斜杠)之前的参数必须按位置传递给函数；当<code>*</code>(星号)作为参数时，<code>*</code>(星号)之后的参数必须按关键字传递给函数。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(pos1, pos2, /, pos_or_kwd, *, kwd1, kwd2)</span>:</span></span><br><span class="line">      -----------    ----------     ----------</span><br><span class="line">        |             |                  |</span><br><span class="line">        |        - 位置参数或关键字参数      |</span><br><span class="line">        |                                - 必须使用关键字参数</span><br><span class="line">         -- 必须按位置</span><br></pre></td></tr></table></figure>

<h2 id="不定长参数"><a href="#不定长参数" class="headerlink" title="不定长参数"></a>不定长参数</h2><ol>
<li>加了星号 <code>*</code> 的参数会以元组的形式导入，存放所有未命名的变量参数,且该参数之后的其它参数仅能使用关键字参数传递<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">myconcat</span><span class="params">(*strs,seq=<span class="string">" "</span>)</span>:</span></span><br><span class="line">    print(seq.join(strs))</span><br><span class="line"></span><br><span class="line">myconcat(<span class="string">"You"</span>,<span class="string">"are"</span>,<span class="string">"a"</span>,<span class="string">"good"</span>,<span class="string">"guy"</span>)</span><br><span class="line">myconcat(<span class="string">"2020"</span>,<span class="string">"03"</span>,<span class="string">"06"</span>,<span class="string">"-"</span>)</span><br><span class="line">myconcat(<span class="string">"2020"</span>,<span class="string">"03"</span>,<span class="string">"06"</span>,seq = <span class="string">"-"</span>)</span><br><span class="line"><span class="comment"># 带*参数后面的参数如需赋值，须使用关键字参数传递，否则会作为元组中的元素处理</span></span><br></pre></td></tr></table></figure>
运行结果：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">You are a good guy</span><br><span class="line">2020 03 06 -</span><br><span class="line">2020-03-06</span><br></pre></td></tr></table></figure></li>
<li>加了<code>**</code> 操作符的参数会以字典的导入<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">printsth</span><span class="params">(arg1 = <span class="string">"default"</span>,**dargs)</span>:</span></span><br><span class="line">    print(arg1)</span><br><span class="line">    <span class="keyword">for</span> k,w <span class="keyword">in</span> dargs.items():</span><br><span class="line">        print(k,<span class="string">"=&gt;"</span>,w)</span><br><span class="line">printsth(arg1=<span class="string">"It's a test!"</span>,a=<span class="string">"one"</span>,b=<span class="string">"two"</span>)</span><br></pre></td></tr></table></figure>
<h2 id="解包参数列表"><a href="#解包参数列表" class="headerlink" title="解包参数列表"></a>解包参数列表</h2>内置的<code>range()</code>函数需要单独的<code>start</code>和<code>stop</code>参数。如果它们不能单独使用，可以使用 <code>*</code>操作符来编写函数调用以便从列表或元组中解包参数:<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>list(range(<span class="number">3</span>, <span class="number">6</span>))            <span class="comment">#常规调用</span></span><br><span class="line">[<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>args = [<span class="number">3</span>, <span class="number">6</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>list(range(*args))            <span class="comment"># 将列表解包来传递参数</span></span><br><span class="line">[<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br></pre></td></tr></table></figure>
字典可使用 ** 操作符 来提供关键字参数:<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">printinfo</span><span class="params">(name,age=<span class="number">18</span>,height=<span class="number">180</span>,weight=<span class="number">150</span>)</span>:</span></span><br><span class="line">    print(name)</span><br><span class="line">    print(<span class="string">"age = "</span>,age)</span><br><span class="line">    print(<span class="string">"height = "</span>,height)</span><br><span class="line">    print(<span class="string">"weight = "</span>,weight)</span><br><span class="line">d = &#123;<span class="string">"name"</span>:<span class="string">"Mike"</span>,<span class="string">"age"</span>:<span class="number">18</span>,<span class="string">"height"</span>:<span class="number">178</span>,<span class="string">"weight"</span>:<span class="number">135</span>&#125;</span><br><span class="line">printinfo(**d)</span><br></pre></td></tr></table></figure>
运行结果：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Mike</span><br><span class="line">age =  18</span><br><span class="line">height =  178</span><br><span class="line">weight =  135</span><br></pre></td></tr></table></figure>
<h1 id="匿名函数"><a href="#匿名函数" class="headerlink" title="匿名函数"></a>匿名函数</h1>python 使用 lambda 来创建匿名函数。匿名是指不使用 def 语句这样标准的形式定义一个函数。例如这个函数返回两个参数的和： <code>lambda a, b: a+b</code><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">incrementor</span><span class="params">(n)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">lambda</span> x: x + n</span><br><span class="line">f = incrementor(<span class="number">21</span>)</span><br><span class="line">print(f(<span class="number">0</span>))</span><br><span class="line">print(f(<span class="number">1</span>))</span><br></pre></td></tr></table></figure>
运行结果：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">21</span><br><span class="line">22</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h1 id="返回值"><a href="#返回值" class="headerlink" title="返回值"></a>返回值</h1><p><code>return [表达式]</code> 语句用于退出函数，选择性地向调用方返回一个表达式。不带参数值的<code>return</code>语句以及若无返回值则返回None。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">testf</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> testf <span class="comment">#返回testf()函数地址</span></span><br><span class="line"></span><br><span class="line">print(testf())</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;function testf at 0x00000285A361A430&gt;</span><br></pre></td></tr></table></figure></div></div><a class="button-hover more" href="/2020/03/03/Python%E5%85%A5%E9%97%A8-%E5%87%BD%E6%95%B0/#more">阅读全文</a></div><div class="recent-post-item"><a class="post-title" href="/2020/02/24/Python%E5%85%A5%E9%97%A8-%E2%80%94-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B-2/">Python入门 — 基本数据类型(2)</a><div class="container"><time class="button-hover post-date"><i class="fas fa-calendar-alt article-icon" aria-hidden="true"></i> 更新于 2020-03-08</time><div class="button-hover categories"><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/Python%E5%85%A5%E9%97%A8/">Python入门</a></div><div class="button-hover tags"><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/Python/">Python</a></div></div><div class="post-content"><div class="main-content content"><h1 id="列表"><a href="#列表" class="headerlink" title="列表"></a>列表</h1><p>列表是最常用的Python数据类型，它可以作为一个方括号内的逗号分隔值出现。<br><br>列表的数据项不需要具有相同的类型</p>
<h2 id="创建列表"><a href="#创建列表" class="headerlink" title="创建列表"></a>创建列表</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">li = [<span class="string">'one'</span>,<span class="string">'two'</span>,<span class="number">1</span>,<span class="number">2</span>]</span><br></pre></td></tr></table></figure>
<h2 id="访问列表"><a href="#访问列表" class="headerlink" title="访问列表"></a>访问列表</h2><ul>
<li>使用下标索引来访问列表中的值</li>
<li>使用方括号的形式截取<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>print( li[<span class="number">0</span>])</span><br><span class="line">one</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print( li[<span class="number">1</span>:<span class="number">3</span>])</span><br><span class="line">[<span class="string">'two'</span>, <span class="number">1</span>]</span><br></pre></td></tr></table></figure>
<h2 id="修改列表"><a href="#修改列表" class="headerlink" title="修改列表"></a>修改列表</h2></li>
<li>对列表的一个或多个数据项进行修改</li>
<li>使用append()方法来添加列表项<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>li[<span class="number">0</span>] = <span class="string">'zero'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(li[<span class="number">0</span>])</span><br><span class="line">zero</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>li[<span class="number">1</span>:<span class="number">4</span>] = [<span class="string">'one'</span>,<span class="number">0</span>,<span class="number">1</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(li[<span class="number">1</span>:<span class="number">4</span>])</span><br><span class="line">[<span class="string">'one'</span>, <span class="number">0</span>, <span class="number">1</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>li.append(<span class="number">2</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(li)</span><br><span class="line">[<span class="string">'zero'</span>, <span class="string">'one'</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>]</span><br></pre></td></tr></table></figure>
<h2 id="删除列表"><a href="#删除列表" class="headerlink" title="删除列表"></a>删除列表</h2>使用 del 语句来删除列表的的元素<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">del</span> li[<span class="number">4</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(li)</span><br><span class="line">[<span class="string">'zero'</span>, <span class="string">'one'</span>, <span class="number">0</span>, <span class="number">1</span>]</span><br></pre></td></tr></table></figure>
<h2 id="列表的函数"><a href="#列表的函数" class="headerlink" title="列表的函数"></a>列表的函数</h2></li>
<li>list.append(obj) 在列表末尾添加新的对象</li>
<li>list.count(obj) 统计某个元素在列表中出现的次数</li>
<li>list.extend(seq) 在列表末尾一次性追加另一个序列中的多个值（用新列表扩展原来的列表）</li>
<li>list.index(obj) 从列表中找出某个值第一个匹配项的索引位置</li>
<li>list.insert(index, obj) 将对象插入列表</li>
<li>list.pop([index=-1]) 移除列表中的一个元素（默认最后一个元素），并且返回该元素的值</li>
<li>list.remove(obj) 移除列表中某个值的第一个匹配项</li>
<li>list.reverse() 反向列表中元素</li>
<li>list.sort( key=None, reverse=False) 对原列表进行排序</li>
<li>list.clear() 清空列表</li>
<li>list.copy() 复制列表</li>
</ul>
<p>list.extend(seq)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>li1 = [<span class="string">'zero'</span>,<span class="string">'one'</span>,<span class="string">'two'</span>]</span><br><span class="line"><span class="comment"># 添加另一列表元素到列表末尾</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>li2 = [<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>li1.extend(li2)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(li1)</span><br><span class="line">[<span class="string">'zero'</span>, <span class="string">'one'</span>, <span class="string">'two'</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加元组元素到列表末尾</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>tup = (<span class="number">3</span>,<span class="number">4</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>li1.extend(tup)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(li1)</span><br><span class="line">[<span class="string">'zero'</span>, <span class="string">'one'</span>, <span class="string">'two'</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加字典元素到列表末尾</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d = &#123;<span class="number">5</span>,<span class="number">6</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>li1.extend(d)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(li1)</span><br><span class="line">[<span class="string">'zero'</span>, <span class="string">'one'</span>, <span class="string">'two'</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br></pre></td></tr></table></figure>
<p>list.insert(index, obj)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>li = [<span class="string">'America'</span>,<span class="string">'Japan'</span>,<span class="string">'England'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>li.insert(<span class="number">0</span>,<span class="string">'China'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(li)</span><br><span class="line">[<span class="string">'China'</span>, <span class="string">'America'</span>, <span class="string">'Japan'</span>, <span class="string">'England'</span>]</span><br></pre></td></tr></table></figure>

<h1 id="元组"><a href="#元组" class="headerlink" title="元组"></a>元组</h1><p>Python 的元组与列表类似，不同之处在于元组的元素不能修改。元组使用小括号，列表使用方括号。</p>
<h2 id="创建元组"><a href="#创建元组" class="headerlink" title="创建元组"></a>创建元组</h2><p>元组创建很简单，只需要在括号中添加元素，并使用逗号隔开即可。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>tup1 = () <span class="comment">#创建空元组</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>tup2 = (<span class="number">1</span>,)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>type(tup2)</span><br><span class="line">&lt;<span class="class"><span class="keyword">class</span> '<span class="title">tuple</span>'&gt;</span></span><br><span class="line"><span class="class"># 元组中只包含一个元素时，需要在元素后面添加逗号，否则括号会被当作运算符使用</span></span><br><span class="line">&gt;&gt;&gt; tup3 = ('one','two',1,2)</span><br></pre></td></tr></table></figure>
<h2 id="访问元组"><a href="#访问元组" class="headerlink" title="访问元组"></a>访问元组</h2><ul>
<li>使用下标索引来访问元组中的值</li>
<li>使用方括号的形式截取的形式<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(tup3[<span class="number">0</span>])</span><br><span class="line">one</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(tup3[<span class="number">2</span>:<span class="number">4</span>])</span><br><span class="line">(<span class="number">1</span>, <span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<h2 id="连接元组"><a href="#连接元组" class="headerlink" title="连接元组"></a>连接元组</h2>元组中的元素值是不允许修改的，但我们可以对元组进行连接组合<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>tup4 = (<span class="number">3</span>,<span class="number">4</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>newtup = tup3 + tup4</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(newtup)</span><br><span class="line">(<span class="string">'one'</span>, <span class="string">'two'</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="删除元组"><a href="#删除元组" class="headerlink" title="删除元组"></a>删除元组</h2><p>元组中的元素值是不允许删除的，但我们可以使用del语句来删除整个元组</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">del</span>(tup4)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(tup4)</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">NameError: name <span class="string">'tup4'</span> <span class="keyword">is</span> <span class="keyword">not</span> defined</span><br></pre></td></tr></table></figure>
<h2 id="tuple-iterable"><a href="#tuple-iterable" class="headerlink" title="tuple(iterable)"></a>tuple(iterable)</h2><p>将可迭代系列转换为元组。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>li = [<span class="string">'one'</span>,<span class="string">'two'</span>,<span class="number">1</span>,<span class="number">2</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>tuple(li)</span><br><span class="line">(<span class="string">'zero'</span>, <span class="string">'one'</span>, <span class="number">0</span>, <span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<h1 id="字典"><a href="#字典" class="headerlink" title="字典"></a>字典</h1><p>元组是一个存储键值对的可变容器模型</p>
<h2 id="创建"><a href="#创建" class="headerlink" title="创建"></a>创建</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>d = &#123;<span class="string">'one'</span>:<span class="number">1</span>,<span class="string">'two'</span>:<span class="number">2</span>,<span class="number">1</span>:<span class="string">'one'</span>,<span class="number">2</span>:<span class="string">'two'</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d[<span class="string">'three'</span>]=<span class="number">3</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d[<span class="number">3</span>]=<span class="string">'three'</span></span><br></pre></td></tr></table></figure>
<h2 id="访问"><a href="#访问" class="headerlink" title="访问"></a>访问</h2><p>键一般是唯一的，如果重复最后的一个键值对会替换前面的，值不需要唯一。值可以取任何数据类型，但键必须是不可变的，如字符串，数字或元组。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(d[<span class="number">1</span>])</span><br><span class="line">one</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(d[<span class="string">'one'</span>])</span><br><span class="line"><span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果用字典里没有的键访问数据，会输出错误如下</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(d)</span><br><span class="line">&#123;<span class="number">1</span>: <span class="string">'one'</span>, <span class="number">2</span>: <span class="string">'two'</span>, <span class="number">3</span>: <span class="string">'three'</span>, <span class="string">'three'</span>: <span class="number">3</span>, <span class="string">'two'</span>: <span class="number">2</span>, <span class="string">'one'</span>: <span class="number">1</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(d[<span class="string">'four'</span>])</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">KeyError: <span class="string">'four'</span></span><br></pre></td></tr></table></figure>
<h2 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">del</span> d[<span class="string">'three'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">del</span> d[<span class="number">3</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(d)</span><br><span class="line">&#123;<span class="number">1</span>: <span class="string">'one'</span>, <span class="number">2</span>: <span class="string">'two'</span>, <span class="string">'two'</span>: <span class="number">2</span>, <span class="string">'one'</span>: <span class="number">1</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除字典内所有元素</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d.clear()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(d)</span><br><span class="line">&#123;&#125;</span><br></pre></td></tr></table></figure>
<h2 id="重要函数"><a href="#重要函数" class="headerlink" title="重要函数"></a>重要函数</h2><ul>
<li>dict.get(key, default=None)   返回指定键的值，如果值不在字典中返回default值</li>
<li>dict.keys()    以列表返回一个字典所有的键</li>
<li>dict.values() 以列表返回字典中的所有值</li>
<li>dict.items()  以列表返回可遍历的(键, 值) 元组数组</li>
<li>dict.update(dict2) 把字典dict2的键/值对更新到dict里</li>
</ul>
<h1 id="集合"><a href="#集合" class="headerlink" title="集合"></a>集合</h1><p>集合（set）是一个无序的不重复元素序列。</p>
<h2 id="集合的创建及关系运算"><a href="#集合的创建及关系运算" class="headerlink" title="集合的创建及关系运算"></a>集合的创建及关系运算</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = &#123;<span class="string">'one'</span>,<span class="string">'two'</span>,<span class="string">'two'</span>,<span class="string">'three'</span>,<span class="string">'four'</span>,<span class="string">'four'</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(s)</span><br><span class="line">&#123;<span class="string">'four'</span>, <span class="string">'three'</span>, <span class="string">'two'</span>, <span class="string">'one'</span>&#125; <span class="comment">#集合中的元素不重复</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = set(<span class="string">'goodboy'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b = set(<span class="string">'badgirl'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(a)</span><br><span class="line">&#123;<span class="string">'y'</span>, <span class="string">'d'</span>, <span class="string">'g'</span>, <span class="string">'b'</span>, <span class="string">'o'</span>&#125; <span class="comment">#集合中的元素不重复</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(b)</span><br><span class="line">&#123;<span class="string">'d'</span>, <span class="string">'l'</span>, <span class="string">'g'</span>, <span class="string">'b'</span>, <span class="string">'i'</span>, <span class="string">'r'</span>, <span class="string">'a'</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = frozenset(<span class="string">'world'</span>) </span><br><span class="line"><span class="comment"># 不可变集合，无法进行添加、删除、清空集合元素操作</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 两个集合间的运算</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(a-b) <span class="comment"># 差集</span></span><br><span class="line">&#123;<span class="string">'o'</span>, <span class="string">'y'</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(a|b) <span class="comment"># 并集</span></span><br><span class="line">&#123;<span class="string">'y'</span>, <span class="string">'d'</span>, <span class="string">'g'</span>, <span class="string">'b'</span>, <span class="string">'i'</span>, <span class="string">'r'</span>, <span class="string">'o'</span>, <span class="string">'l'</span>, <span class="string">'a'</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(a&amp;b) <span class="comment"># 交集</span></span><br><span class="line">&#123;<span class="string">'d'</span>, <span class="string">'b'</span>, <span class="string">'g'</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(a^b) <span class="comment"># 不同时包含于a和b的元素</span></span><br><span class="line">&#123;<span class="string">'y'</span>, <span class="string">'r'</span>, <span class="string">'i'</span>, <span class="string">'o'</span>, <span class="string">'l'</span>, <span class="string">'a'</span>&#125;</span><br></pre></td></tr></table></figure>
<h2 id="集合的基本操作"><a href="#集合的基本操作" class="headerlink" title="集合的基本操作"></a>集合的基本操作</h2><ul>
<li>set.add(x) 为集合添加元素</li>
<li>set.update(x) 为集合添加元素，且参数可以是列表，元组，字典等</li>
<li>set.remove(x) 移除指定元素，如果元素不存在，则会发生错误。</li>
<li>set.discard(x) 移除指定元素，且如果元素不存在，不会发生错误。</li>
<li>set.pop() 返回一个随机移除元素的值</li>
<li>set.clear() 清空集合</li>
</ul>
</div></div><a class="button-hover more" href="/2020/02/24/Python%E5%85%A5%E9%97%A8-%E2%80%94-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B-2/#more">阅读全文</a></div><div class="recent-post-item"><a class="post-title" href="/2020/02/20/Python%E5%85%A5%E9%97%A8-%E2%80%94-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B-1/">Python入门 — 基本数据类型(1)</a><div class="container"><time class="button-hover post-date"><i class="fas fa-calendar-alt article-icon" aria-hidden="true"></i> 更新于 2020-03-10</time><div class="button-hover categories"><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/Python%E5%85%A5%E9%97%A8/">Python入门</a></div><div class="button-hover tags"><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/Python/">Python</a></div></div><div class="post-content"><div class="main-content content"><p>注：该博客是作者学习Python时写的笔记，用于巩固作用，不够完善，仅为参考，若要较完善的资料，推荐去去翻阅<a src="https://docs.python.org/zh-cn/3/index.html">Python开发文档</a>、<a src="https://www.runoob.com/python3/python3-tutorial.html">菜鸟教程</a>以及<a src="https://www.liaoxuefeng.com/wiki/1016959663602400">廖雪峰的官方网站</a>，同时我的博客也是参考这些网站进行写作的。<br><br>Python3 中有六个标准的数据类型：</p>
<ul>
<li>Number（数字）</li>
<li>String（字符串）</li>
<li>List（列表）</li>
<li>Tuple（元组）</li>
<li>Set（集合）</li>
<li>Dictionary（字典）</li>
</ul>
<h1 id="Number（数字）"><a href="#Number（数字）" class="headerlink" title="Number（数字）"></a>Number（数字）</h1><h2 id="类型"><a href="#类型" class="headerlink" title="类型"></a>类型</h2><ul>
<li>整形(int)  二、八、十、十六进制</li>
<li>浮点型(float)</li>
<li>复数(complex)</li>
</ul>
<h2 id="类型转换"><a href="#类型转换" class="headerlink" title="类型转换"></a>类型转换</h2><pre><code>int(x)  #转换为整数
float(x)  #转换为浮点数
complex(x) #实数部分为 x，虚数部分为 0。  
complex(x,y)  #实数部分为 x，虚数部分为 y。      </code></pre><h2 id="数学函数"><a href="#数学函数" class="headerlink" title="数学函数"></a>数学函数</h2><ul>
<li><p>以下函数与常量需要import math<br>  数学函数：绝对值、指数、对数、开方、上取整、下取整、最大值、最小值</p>
<pre><code>abs() fabs() 绝对值函数
ceil() 上舍整数
floor() 下舍整数
exp(x) e的x次幂
log(x) =&gt; lnx   log(a,b) b为底的对数
pow(x,y) x的y次方幂
sqrt(x) 平方根
max(x1,x2...)
min(x1,x2...)
# cmp(x,y)在python3中废置，改用(x&gt;y)-(x&lt;y)代替 </code></pre><p>  随机数函数：</p>
<pre><code>random() [0,1)范围内</code></pre><p>  三角函数：</p>
<pre><code>sin() cos() tan()</code></pre><p>  反三角函数：</p>
<pre><code>asin() acos() atan()</code></pre><p>  数学常数：</p>
<pre><code>pi   e</code></pre></li>
</ul>
<h1 id="String（字符串）"><a href="#String（字符串）" class="headerlink" title="String（字符串）"></a>String（字符串）</h1><p>  在Python2中，普通字符串是以8位ASCII码进行存储的，而Unicode字符串则存储为16位unicode字符串，这样能够表示更多的字符集。使用的语法是在字符串前面加上前缀 u。<br><br>  在Python3中，所有的字符串都是Unicode字符串。</p>
<h2 id="转义字符（常用）"><a href="#转义字符（常用）" class="headerlink" title="转义字符（常用）"></a>转义字符（常用）</h2><pre><code>\n 换行
\t 制表符
\r 回车</code></pre><h2 id="字符串格式化"><a href="#字符串格式化" class="headerlink" title="字符串格式化"></a>字符串格式化</h2><pre><code>%c 字符

%d 整数
%u 无符号整数
%o 无符号八进制
%x 无符号十六进制
%f 浮点数，可指定精度
%e 浮点数，用科学计数法格式化浮点数

%s 字符串
%r 对象
%p 用十六进制数格式化变量的地址</code></pre><ul>
<li>format 格式化函数<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"&#123;&#125; &#123;&#125;"</span>.format(<span class="string">"zero"</span>,<span class="string">"one"</span>) <span class="comment"># 不设置指定位置，按默认顺序</span></span><br><span class="line"><span class="string">'zero one'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"&#123;0&#125; &#123;1&#125;"</span>.format(<span class="string">"zero"</span>,<span class="string">"one"</span>) <span class="comment"># 设置指定位置</span></span><br><span class="line"><span class="string">'zero one'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"&#123;0&#125; &#123;1&#125; &#123;0&#125;"</span>.format(<span class="string">"zero"</span>,<span class="string">"one"</span>) <span class="comment"># 设置指定位置</span></span><br><span class="line"><span class="string">'zero one zero'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过字典设置参数</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"&#123;first&#125; heart &#123;second&#125; minds"</span>.format(first=<span class="string">'one'</span>,second=<span class="string">'two'</span>)</span><br><span class="line"><span class="string">'one heart two minds'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"&#123;first&#125; heart &#123;second&#125; minds"</span>.format(&#123;<span class="string">'first'</span>:<span class="string">'one'</span>,<span class="string">'second'</span>:<span class="string">'two'</span>&#125;)</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">KeyError: <span class="string">'first'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"&#123;first&#125; heart &#123;second&#125; minds"</span>.format(**&#123;<span class="string">'first'</span>:<span class="string">'one'</span>,<span class="string">'second'</span>:<span class="string">'two'</span>&#125;)</span><br><span class="line"><span class="string">'one heart two minds'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过列表索引设置参数</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>li = [<span class="string">'Joker'</span>,<span class="string">'boy'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"&#123;0[0]&#125; is a &#123;0[1]&#125;"</span>.format(li)</span><br><span class="line"><span class="string">'Joker is a boy'</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2 id="字符串运算"><a href="#字符串运算" class="headerlink" title="字符串运算"></a>字符串运算</h2><pre><code>+ 字符串拼接
* 字符串重复
[] 字符串索引
r/R 原始字符串：所有的字符串都是直接按照字面的意思来使用，没有转义特殊或不能打印的字符。</code></pre><h2 id="f-string"><a href="#f-string" class="headerlink" title="f-string"></a>f-string</h2><p>f-string 是 python3.6 之后版本添加的，称之为字面量格式化字符串，是新的格式化字符串的语法。</p>
<pre><code>name = &apos;Joker&apos;
&apos;Hello %s&apos; % name
f&apos;Hello {name}&apos; </code></pre><h2 id="常用字符串内置函数"><a href="#常用字符串内置函数" class="headerlink" title="常用字符串内置函数"></a>常用字符串内置函数</h2><pre><code>len(str) 返回字符串长度</code></pre><p>分割与连接：</p>
<pre><code>split(str=&quot;&quot;, num=string.count(str)) #以 str 为分隔符截取字符串，如果 num 有指定值，则仅截取 num+1 个子字符串
join(seq) #以指定字符串作为分隔符，将 seq 中所有的元素(的字符串表示)合并为一个新的字符串</code></pre><p>判断大小写，字母，数字…:</p>
<pre><code>isalnum() #如果字符串至少有一个字符并且所有字符都是字母或数字则返 回 True,否则返回 False
isalpha() #如果字符串至少有一个字符并且所有字符都是字母则返回 True, 否则返回 False
isdigit() #如果字符串只包含数字则返回 True 否则返回 False..，这的数字指阿拉伯数字
isnumeric() #如果字符串中只包含数字字符，则返回 True，否则返回 False，数字可以是： Unicode 数字，全角数字（双字节），罗马数字，汉字数字。
islower() #如果字符串中包含至少一个区分大小写的字符，并且所有这些(区分大小写的)字符都是小写，则返回 True，否则返回 False
isupper() #如果字符串中包含至少一个区分大小写的字符，并且所有这些(区分大小写的)字符都是大写，则返回 True，否则返回 False</code></pre><p>转换</p>
<pre><code>upper() #转换字符串中所有小写字符为大写.

lower() #转换字符串中所有大写字符为小写.</code></pre><p>填充</p>
<pre><code>ljust(width[, fillchar]) #返回一个原字符串左对齐,并使用 fillchar 填充至长度 width 的新字符串，fillchar 默认为空格。
rjust(width[, fillchar]) #返回一个原字符串右对齐,并使用fillchar(默认空格）填充至长度 width 的新字符串
zfill(width) #返回长度为 width 的字符串，原字符串右对齐，前面填充0</code></pre><p>查找</p>
<pre><code>find(str, beg=0, end=len(string)) #检测 str 是否包含在字符串中，如果指定范围 beg 和 end ，则检查是否包含在指定范围内，如果包含返回开始的索引值，否则返回-1
rfind(str, beg=0, end=len(string)) #返回字符串最后一次出现的位置，如果没有匹配项则返回-1。
index(str, beg=0, end=len(string)) #检测字符串中是否包含子字符串 str ，如果指定 beg（开始） 和 end（结束） 范围，则检查是否包含在指定范围内，该方法与 python find()方法一样，只不过如果str不在 string中会报一个异常。</code></pre></div></div><a class="button-hover more" href="/2020/02/20/Python%E5%85%A5%E9%97%A8-%E2%80%94-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B-1/#more">阅读全文</a></div><div class="recent-post-item"><a class="post-title" href="/2020/01/11/bugku-%E5%88%86%E6%9E%90/">bugku 分析</a><div class="container"><time class="button-hover post-date"><i class="fas fa-calendar-alt article-icon" aria-hidden="true"></i> 更新于 2020-02-24</time><div class="button-hover categories"><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/Web/">Web</a></div><div class="button-hover tags"><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/%E5%88%86%E6%9E%90/">分析</a></div></div><div class="post-content"><div class="main-content content"><p>最近刷了一下bugku中关于分析的题目，其中有几道还是比较有意思的，写下博客来巩固一下。</p>
<h1 id="flag被盗"><a href="#flag被盗" class="headerlink" title="flag被盗"></a>flag被盗</h1><p>在分组字节流中搜索字符串flag，发现一个flag.txt</p>
<p><img src="/images/a601.png" alt="search"><br>追踪http流，发现flag</p>
<p><img src="/images/a602.png" alt="http_stream"></p>
<h1 id="中国菜刀"><a href="#中国菜刀" class="headerlink" title="中国菜刀"></a>中国菜刀</h1><p>看到中国菜刀，第一反应便是一句话木马，在分组字节流中搜索eval关键词，发现一句话木马，并且发现可疑文件3.php</p>
<p><img src="/images/a603.png" alt="ma"><br>然后再查看通过3.php进行哪些操作，最后在数据包后面追踪http数据流发现3.php获取了一个flag.tar.gz的文件</p>
<p><img src="/images/a604.png" alt="3php"></p>
<p><img src="/images/getflag.png" alt="getflag"><br>对http流中的$xx(后字符串进行URL解码然后进行base64解码，得到以下内容</p>
<pre><code>@ini_set(&quot;display_errors&quot;,&quot;0&quot;); 
@set_time_limit(0);    if(PHP_VERSION&lt;&apos;5.3.0&apos;{@set_magic_quotes_runtime(0);};echo(&quot;X@Y&quot;);
$F=&quot;C:\\wwwroot\\flag.tar.gz&quot;;
$fp=@fopen($F,&apos;r&apos;)
if(@fgetc($fp{@fclose($fp);@readfile($F);}
else{echo(&apos;ERROR:// Can Not Read&apos;);};
echo(&quot;X@Y&quot;);
die();</code></pre><p>导出第32数据包的http对象,保存为后缀名为.tar.gz的文件</p>
<p><img src="/images/a605.png" alt="http_obj"></p>
<p><img src="/images/a606.png" alt="32obj"><br>解压得到flag.txt</p>
<p><img src="/images/a607.png" alt="getfinalflag"></p>
<h1 id="这么多数据包"><a href="#这么多数据包" class="headerlink" title="这么多数据包"></a>这么多数据包</h1><p>我们使用wireshark打开该文件，可以看到数据包非常多，先使用字符串对分组列表和分组数据流查找flag关键字，并没有啥发现，浏览一下数据，可以看出ip地址为192.168.116.138的主机在对ip地址为192.168.116.159的主机发送大量数据包进行端口探测，猜测ip地址为192.168.116.138的主机为攻击机。<br><img src="/images/a608.png" alt="search_port"><br>有题目可知攻击机拿到了主机的shell权限，将过滤器设置为ip.addr=192.168.116.139，然后一直往下翻，在一片红色结束后的地方，发现ip地址为192.168.116.139主机的4444端口在不断的向192.168.116.159的主机发送数据包，然后对其进行追踪tcp流，然后导出其中的数据包进行查找flag，都没有发现flag。<br><br>再继续往下翻,忽略4444端口&lt;–&gt;1040端口通信的数据包，然后发现35880端口与1040端口通信的数据包，进行追踪tcp流，发现这是getshell的流，并发现一串攻击机从被攻击主机中查看的的s4cr4t.txt文件中的一段base64编码字符串。</p>
<p><img src="/images/a609.png" alt="getshell"></p>
<p><img src="/images/a610.png" alt="base64"><br>对base64编码的字符串进行解码即可得到flag</p>
<p><img src="/images/a611.png" alt="getflag"></p>
<h1 id="手机热点"><a href="#手机热点" class="headerlink" title="手机热点"></a>手机热点</h1><p>Ctrl+f在分组字节流查找flag关键字，发现flag.gif与secret.rar</p>
<p><img src="/images/a612.png" alt="secret"><br>导出该分组，并使用foremost对其进行分离，得到以下文件：</p>
<p><img src="/images/a613.png" alt="documents"><br>对rar文件夹中的rar文件进行解压，得到flag.gif</p>
<p><img src="/images/a614.png" alt="getflag"></p>
<h1 id="抓到一只苍蝇"><a href="#抓到一只苍蝇" class="headerlink" title="抓到一只苍蝇"></a>抓到一只苍蝇</h1><p>根据题目提示，搜索分组列表和分组字节流中的字符串fly，找到以下结果：</p>
<p><img src="/images/a615.png" alt="15"></p>
<p><img src="/images/a616.png" alt="16"></p>
<p><img src="/images/a617.png" alt="17"><br>由图可知，在进行邮件传输，且文件名为fly.rar。<br><br>将过滤器设置为只查看POST传输的模式，查看传输内容，</p>
<p><img src="/images/a618.png" alt="18"><br>发现ip为192.168.1.101的主机向ip地址为59.37.116.102的主机发送的几个数据包中数据均是相同的开头，并可以猜测这几个数据包是基于同一种协议分段发送的文件。且前四个数据包大小相同均为131436bytes，最后一个大小为1777bytes，总大小为131436 x 4 + 1777 = 527521，图一的文件fly.rar大小为525701，两者大小相似，可以猜测这5个数据包传输的文件即为fly.rar</p>
<p><img src="/images/a619.png" alt="19"></p>
<p><img src="/images/a620.png" alt="20"><br>使用导出对象中的http，对照分组编号，将这5个文件的数据包提取出来，并按顺序命名，</p>
<p><img src="/images/a621.png" alt="21"></p>
<p><img src="/images/a622.png" alt="22"><br>使用二进制编辑器查看001文件(我使用的是010 Editor)，找出文件数据前的协议头内容</p>
<p><img src="/images/a623.png" alt="23"><br>然后有两种方法将这几个数据包的数据组装回fly.rar文件，第一种方法是新建二进制文件，将这五个文件协议头内容后面的内容依次复制到新建的二进制文件种，然后保存为rar格式文件，第二种方法是将这五个文件的前面的协议头内容去除，然后使用cmd的命令将其合成 copy /B 001+002+003+004+005 flag.rar。<br>然后对其进行解压，发现警告，文件头损坏，并且需要输入密码，</p>
<p><img src="/images/a624.png" alt="24"><br>使用二进制编辑器010 Editor进行查看，发现是rar文件的文件块部分(rar文件由几个文件块组成，文件块为其中一个块)的头标记为加密标记</p>
<p><img src="/images/a625.png" alt="25"><br>0x74是块类型的标志，代表这个块是文件块，后面是0x84的4表示进行了加密，将其修改为0，便可以成功解压文件(对rar文件格式不进行过多讲解，可自行百度)。<br>解压之后，发现是个txt文件，但打开后发现这是个windows系统下的一个程序 </p>
<p><img src="/images/a626.png" alt="26"><br>将文件后缀名更改为exe，并运行，然后你的电脑屏幕就出现了五只苍蝇。。。。。。<br><br>对文件搜索flag使用strings命令搜索，看是否存在隐藏信息，发现并没有。然后使用binwalk对软件进行分析，发现一堆png文件，使用foremost对文件进行分离，在一堆苍蝇图中发现一个二维码</p>
<p><img src="/images/a627.png" alt="27"><br>扫描该二维码即可得到flag</p>
<p><img src="/images/a628.png" alt="28"><br>（这题关键在于找出传输的文件，对rar文件的了解，以及对文件进行分析。）</p>
<h1 id="日志审计"><a href="#日志审计" class="headerlink" title="日志审计"></a>日志审计</h1><p>这题的知识点主要在于基于布尔型的sql盲注，对请求头进行url解码，然后获得爆出的flag的字符的ascii值，再转成字符就行了</p>
<p><img src="/images/a629.png" alt="picture"><br>判断flag某个字符的ascii的值的方法为：看在测试该字符的最后一次ascii的值，若是该值的返回为200，则该字符值为这最后一次的ascii值+1；若返回值为404，则该字符的ascii值即为这最后一次的ascii值。<br><br>可人工得到的flag的ascii值: 102, 108, 97, 103, 123, 115, 112, 108, 109, 52, 112, 95, 49, 53, 95, 112, 48, 119, 101, 114, 102, 117, 108, 125<br>转成字符为: flag{splm4p_15_p0werful}<br>也可使用一下脚本来获取flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">import re</span><br><span class="line">f = open(&apos;access.log&apos;, &apos;r&apos;)</span><br><span class="line">flag = &#123;&#125;</span><br><span class="line">for line in f.readlines():</span><br><span class="line">    st = re.search(r&apos;LIMIT 0,1\),(\d*?),1\)\)&gt;(\d*?) AND \&apos;RCKM\&apos;\=\&apos;RCKM&amp;Submit\=Submit HTTP/1.1\&quot; (\d*?) &apos;, line)</span><br><span class="line">    if st:</span><br><span class="line">        x = int(st.group(1))</span><br><span class="line">        y = int(st.group(2))</span><br><span class="line">        z = int(st.group(3))</span><br><span class="line">        if z == 200:</span><br><span class="line">            v = y + 1</span><br><span class="line">        else:</span><br><span class="line">            v = y</span><br><span class="line">        flag[x] = int(v)</span><br><span class="line">f.close()</span><br><span class="line">rs = &apos;&apos;</span><br><span class="line">for fl in flag.values():</span><br><span class="line">    rs = rs + chr(fl)</span><br><span class="line">print(rs)</span><br></pre></td></tr></table></figure>
<p>运行结果为：</p>
<p><img src="/images/script1.png" alt="script"></p>
<h1 id="weblogic"><a href="#weblogic" class="headerlink" title="weblogic"></a>weblogic</h1><p>根据题目提示在分组字节流中搜索字符串hostname，找到数据包</p>
<p><img src="/images/a630.png" alt="hostname"><br>追踪http流，并在http流中搜索hostname即可得到主机名，即flag:</p>
<p><img src="/images/a631.png" alt="gettheflag"></p>
<h1 id="信息提取"><a href="#信息提取" class="headerlink" title="信息提取"></a>信息提取</h1><p>这题与日志审计的题类似，知识点都是基于布尔型的sql盲注,将过滤器设置为http or http2，不同点在于这题在进行盲注时，若是条件为假，依然返回200，但追踪http流可发现，条件为真与返回的数据包与条件为假时返回的数据包不同，当条件为真时，数据包长度为460左右；当条件为假时，数据包长度为430左右，所以可以选择一个合适的长度来进行判断字符的ascii值。</p>
<p><img src="/images/a632.png" alt="http"><br>然后导出分组解析结果为CSV文件</p>
<p><img src="/images/a633.png" alt="csv"><br>然后使用notepad++打开，并进行URL解码，然后接下来的步骤便与“日志审计”一题类似，可手工，也可写脚本进行处理。处理脚本如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">f = open(<span class="string">'save.csv'</span>, <span class="string">'r'</span>)</span><br><span class="line">x = <span class="number">0</span></span><br><span class="line">y = <span class="number">0</span></span><br><span class="line">z = <span class="number">0</span></span><br><span class="line">flag = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> f.readlines():</span><br><span class="line">    st = re.search(<span class="string">r'LIMIT 0,1\),(\d*?),1\)\)&gt;(\d*?) HTTP/1\.1'</span>, line)</span><br><span class="line">    st2 = re.search(<span class="string">r'\"(\d*?)\",\"HTTP/1.1'</span>, line)</span><br><span class="line">    <span class="keyword">if</span> st:</span><br><span class="line">        x = int(st.group(<span class="number">1</span>))</span><br><span class="line">        y = int(st.group(<span class="number">2</span>))</span><br><span class="line">    <span class="keyword">if</span> st2:</span><br><span class="line">        z = int(st2.group(<span class="number">1</span>))</span><br><span class="line">        <span class="keyword">if</span> z &gt; <span class="number">450</span>:</span><br><span class="line">            v = y+<span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            v = y</span><br><span class="line">        flag[x] = v</span><br><span class="line">f.close()</span><br><span class="line">rs = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> fl <span class="keyword">in</span> flag.values():</span><br><span class="line">    rs = rs + chr(fl)</span><br><span class="line">print(rs)</span><br></pre></td></tr></table></figure>
<p>运行结果为：<br><img src="/images/script2.png" alt="script"></p>
<h1 id="特殊后门"><a href="#特殊后门" class="headerlink" title="特殊后门"></a>特殊后门</h1><p>在分组字节流中搜索字符串flag,找到icmp数据包</p>
<p><img src="/images/a635.png" alt="icmp"><br>然后查看后面这些异常的icmp数据包，发现flag被分割成一个个字符隐藏在其中</p>
<p><img src="/images/a636.png" alt="getflag"></p>
</div></div><a class="button-hover more" href="/2020/01/11/bugku-%E5%88%86%E6%9E%90/#more">阅读全文</a></div><div class="recent-post-item"><a class="post-title" href="/2019/11/23/%E8%89%B2%E5%BD%A9%E5%B9%B3%E8%A1%A1%E4%B8%8E%E8%9E%8D%E5%90%88%E7%94%A8%E4%BA%8E%E6%B0%B4%E4%B8%8B%E5%9B%BE%E5%83%8F%E5%A2%9E%E5%BC%BA-matlab%E5%AE%9E%E7%8E%B0/">色彩平衡与融合用于水下图像增强(matlab实现)</a><div class="container"><time class="button-hover post-date"><i class="fas fa-calendar-alt article-icon" aria-hidden="true"></i> 更新于 2020-03-09</time><div class="button-hover categories"><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/%E6%B0%B4%E4%B8%8B%E5%9B%BE%E5%83%8F%E5%A2%9E%E5%BC%BA/">水下图像增强</a></div><div class="button-hover tags"><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86/">图像处理</a></div></div><div class="post-content"><div class="main-content content"><p>最近出于作业的需要，阅读了关于水下图像增强的论文《Color Balance and Fusion for Underwater Image Enhancement》，并且尝试着按照论文中所介绍的步骤使用matlab来实现，由于本人对图像处理初次接触，感觉做出来的效果一般，本文对论文提及的步骤进行简略介绍，代码是按照论文步骤做的，并不十分完善，此论文主要用于学习交流，若是有大佬看完本文，有好的建议愿意提供，欢迎QQ或邮箱联系。</p>
<h2 id="光的水下传播"><a href="#光的水下传播" class="headerlink" title="光的水下传播"></a>光的水下传播</h2><p><img src="/images/a502.png" alt="light"></p>
<p><img src="/images/a503.png" alt="jaffe_mc"><br>Jaffe-McGlamery图像模型，在水下介质中，一般像平面上的点上的总辐照度入射有三个主要分量:直接分量、前向散射和后向散射。<br><br><em>直接分量</em>是被目标物体直接反射到成像平面上的光分量，可表示为：<br><img src="/images/a504.png" alt="eq1"><br><em>前向散射</em>是由于光线在进入相机镜头的过程中发生了随机偏差。<br><br><em>后向散射</em>是由于人造光(如闪光)撞击水粒子，并反射回相机。表示为：<br><img src="/images/a505.png" alt="eq2"><br>忽略前向散射分量，简化水下光学模型为:<br><img src="/images/a506.png" alt="eq3"></p>
<p style="color:red;">论文提出的图像增强方法采用了两步策略，结合白平衡和图像融合来改善水下图像，而不需要借助于光学模型的显式反演。</p>

<h2 id="总体流程介绍"><a href="#总体流程介绍" class="headerlink" title="总体流程介绍"></a>总体流程介绍</h2><p>该论文提出的图像增强方法采用了两步策略，结合白平衡和图像融合来增强水下图像。<br><img src="/images/a501.png" alt="process"><br>白平衡的目的是补偿由颜色的深度选择性吸收造成的颜色投射，而图像融合的目的是增强场景的边缘和细节，以减轻由于后向散射造成的对比度损失。</p>
<h2 id="白平衡"><a href="#白平衡" class="headerlink" title="白平衡"></a>白平衡</h2><p>现有的白平衡算法基本都是基于一定的假设和先验条件。常见的白平衡算法有Max RGB、Gray World、Gray Edge。其中灰色世界算法对于合理失真的水下场景具有良好的视觉效果。然而，对极度恶化的水下场景进行更深入的研究发现，大多数传统方法的性能都很差。它们不能消除颜色的变化，通常看起来是蓝色的。最好的去除蓝色调的方法是灰色世界，但是我们观察到这种方法有严重的红色伪影。这些伪影是由于红色通道的一个非常小的平均值，导致该通道在出现红色的位置上的过度补偿(因为灰色世界通过其平均值来分割每个通道)。<br><br>论文中提出的白平衡算法基于以下四个观察/原则：</p>
<ol>
<li>与红色和蓝色的水道相比，绿色的水道在水下保存相对完好。长波长的光，即红光，在清澈的水中首先会消失;</li>
<li>绿色通道是相对于红色通道包含对手颜色信息的通道，因此补偿红色比绿色引起的更强的衰减尤为重要。因此，我们通过在红色通道中加入绿色通道的一部分来补偿红色衰减。我们最初尝试在红色中加入绿色和蓝色的部分，但论文经测试提出，只使用绿色通道的信息可以更好地恢复整个色谱，同时保持背景(水域)的自然外观;</li>
<li>补偿应与平均绿值和平均红值的差值成比例，因为在灰色世界假设下(所有通道在衰减前的平均值相同)，这种差值反映了红绿衰减之间的差异/不平衡;</li>
<li>为了避免在灰色世界算法中的红损耗补偿后的红通道饱和，对红通道的增强应该主要影响红通道值较小的像素值，而不应该改变已经包含重要红分量的像素。换句话说，绿色通道信息不应该在红色通道信息仍然重要的区域进行传输。</li>
</ol>
<p><img src="/images/a507.png" alt="upload"><br>论文中提到某些水质恶劣的图片是，可能需要对红色和蓝色通道补偿，所有作者在代码实现时，定义了一个阈值K，若绿色通道与蓝色通道的比值大于K，则对红色通道和蓝色通道均进行补偿；否则，只对红色通道进行补偿。</p>
<h2 id="锐化与Gamma变换"><a href="#锐化与Gamma变换" class="headerlink" title="锐化与Gamma变换"></a>锐化与Gamma变换</h2><p>Gamma变换：一般而言，白平衡水下图像往往显得太亮。<br>锐化：非锐化掩模<br>典型的掩模公式：S = I +β(I-GI),较小的β不能锐化I，但过大的β会导致过饱和区域，具有较亮的高光和较暗的阴影，论文使用的掩模公式：S=(I+N{I-GI})/2</p>
<h2 id="融合过程中的权重"><a href="#融合过程中的权重" class="headerlink" title="融合过程中的权重"></a>融合过程中的权重</h2><ol>
<li>拉普拉斯对比度权重<br><br>通过计算应用于每个输入亮度通道的拉普拉斯滤波器的绝对值来估计全局对比度。它为边缘和纹理分配了高值。然而，对于水下去雾任务，这个权值不足以恢复对比度，主要是因为它无法区分斜坡和平坦区域。</li>
<li>显著性权重<br><br>突出在水下场景中失去显著性的显著对象。<br></li>
<li>饱和权重<br><br>对高饱和区域的优化，使融合算法能够适应彩色信息。<br></li>
</ol>
<h2 id="金字塔建立及融合"><a href="#金字塔建立及融合" class="headerlink" title="金字塔建立及融合"></a>金字塔建立及融合</h2><p>多尺度分解基于拉普拉斯金字塔。金字塔表示将图像分解为带通图像的和。</p>
<p><img src="/images/a508.png" alt="eq4"></p>
<p>两个金字塔具有相同的层数，并且在每层上独立地执行拉普拉斯输入与高斯归一化权重的混合：</p>
<p><img src="/images/a509.png" alt="eq5"></p>
<h2 id="处理结果及代码链接"><a href="#处理结果及代码链接" class="headerlink" title="处理结果及代码链接"></a>处理结果及代码链接</h2><p><img src="/images/a510.png" alt="result1"></p>
<p><img src="/images/a511.png" alt="result2"></p>
<p><img src="/images/a512.png" alt="result3"></p>
<p>代码链接：<a href="https://github.com/PowerfulJoker/Underwater_Image" target="_blank" rel="noopener">https://github.com/PowerfulJoker/Underwater_Image</a></p>
</div></div><a class="button-hover more" href="/2019/11/23/%E8%89%B2%E5%BD%A9%E5%B9%B3%E8%A1%A1%E4%B8%8E%E8%9E%8D%E5%90%88%E7%94%A8%E4%BA%8E%E6%B0%B4%E4%B8%8B%E5%9B%BE%E5%83%8F%E5%A2%9E%E5%BC%BA-matlab%E5%AE%9E%E7%8E%B0/#more">阅读全文</a></div></div><div id="pagination"><div class="pagination"><span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">&lt;i class=&quot;fas fa-angle-right&quot;&gt;&lt;&#x2F;i&gt;</a></div></div></div></div><div class="button-hover" id="return-top"><i class="fas fa-arrow-up" aria-hidden="true"></i></div><footer><div id="footer"><div class="button-hover" id="side-button"><i class="fas fa-arrow-right"></i></div><div class="right-content"><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv"><i class="fas fa-user"></i></span><span id="busuanzi_value_site_uv"></span><span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv"><i class="fas fa-eye"></i></span><span id="busuanzi_value_site_pv"></span><span></span></div><div class="copyright">&copy;2017 ～ 2020 By 某獠</div></div></div></footer></div><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/thirdparty/jquery-3.3.1.min.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/thirdparty/velocity.min.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/thirdparty/jquery.mCustomScrollbar.concat.min.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/fan.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/canvas_bg.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/utils.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/scroll.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/sidebar.js"></script><!--script(src=url)--><!--js(src=url_for(url) + '?version=' + version())--><script src="/js/copy.js"></script><!--script(src=url)--></body></html>